<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Chat Server</title><meta name="color-scheme" content="dark light"><link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ’¬</text></svg>"><style>button,input,textarea{font-size:1rem}:root,input,textarea{font-family:"Open Sans",sans-serif}#post,header,ul#chat>li{background-color:var(--clr-1)}#post,.flex,textarea{width:100%}.flex,form,header{display:flex}:root{font-size:16px;--clr-1:light-dark(#0000001a,#ffffff1a)}*{box-sizing:border-box}body,h1{margin:0}button,ul#chat>li{margin:.4rem;padding:.4rem}#messages{max-width:1100px;margin:0 auto}ul#chat{list-style:none;padding-left:0}ul#chat>li{word-wrap:break-word;width:fit-content;border-radius:1rem}header{padding:0 .8rem;justify-content:space-between;align-items:center}header a{text-decoration:none;color:CanvasText}#disclaimer{text-align:center}#post{position:fixed;bottom:0;padding:.4rem}form{gap:1rem;justify-content:space-between}.dialog-menu,.dialog-menu[open].dialog-menu--closing{position:fixed;margin:0 0 0 auto;min-height:100vh;width:400px;max-width:80%;transform:translateX(100%);border:0;padding-top:0}.dialog-menu[open]{margin:0 0 0 auto;transform:translateX(0)}.dialog-menu button:first-child{display:block;margin-left:auto;margin-right:0}</style></head><body><header><h1><a href="#">ðŸ’¬ Chat Server</a></h1><button onclick="openMenu()">â˜°</button></header><dialog class="dialog-menu"><button onclick="closeMenu()" class="close-button">X</button><ul><li>Free space:<span id="freeSpace"></span>bytes</li><li>Last write:<span id="lastWrite"></span></li></ul><button onclick="deleteMessages()">Delete all messages</button><button onclick="toggleBlynk()">Toggle blynk</button></dialog><main><div id="messages"><p id="disclaimer">loading messages...</p><ul id="chat"></ul></div><form action="sendText" method="post" id="post" onsubmit="onPostMessage()"><label>Nickname<br><input name="nickname" id="nickname" type="text" value="Steve" size="6" required></label><div class="flex"><textarea id="text" name="text" placeholder="Type your message..." required></textarea><input type="submit" value="Send"></div></form></main><script>let menuDialog;function openMenu(){fetch("/getFreeSpace").then(e=>e.text().then(e=>{document.getElementById("freeSpace").textContent=e})),fetch("/lastWrite").then(e=>e.text().then(e=>{document.getElementById("lastWrite").textContent=e})),menuDialog.showModal()}function closeMenu(){menuDialog.close()}function toggleBlynk(){fetch("/toggleBlynk").then(e=>e.text().then(e=>{alert(e)}))}function deleteMessages(){window.confirm("Are you sure to delete all messages from server?")&&fetch("/clear").then(e=>e.text().then(e=>{alert(e)}))}function onPostMessage(){this.nickname.value!==localStorage.getItem("nickname")&&localStorage.setItem("nickname",this.nickname.value)}function changeChatText(e){e=e.split("|");let t=document.getElementById("chat");t.innerHTML="";let n=document.getElementById("disclaimer");if(e.length-1==0){n.style.display="",n.textContent="Be the first one to leave a message :)";return}for(i=0,n.style.display="none";i<e.length-1;i++){let l=document.createElement("li");l.appendChild(document.createTextNode(e[i])),t.appendChild(l)}}function getText(){fetch("/showText").then(e=>e.text().then(e=>{changeChatText(e)}))}var cache="";function sync(){setInterval(()=>{fetch("/lastWrite").then(e=>e.text().then(e=>{cache!==e&&(cache=e,getText())}))},1e3)}window.onload=()=>{null!==localStorage.getItem("nickname")&&(document.getElementById("nickname").value=localStorage.getItem("nickname")),sync(),menuDialog=document.querySelector(".dialog-menu")};</script></body></html>